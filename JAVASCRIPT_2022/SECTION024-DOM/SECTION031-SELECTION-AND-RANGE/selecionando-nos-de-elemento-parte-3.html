<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>

    <p id="p">Exemplo: <i>itálico</i> e <b>negrito</b></p>

    <!--
    no de elemento como um todo
    <p id="p">       no de elemento completo <p>
        Exemplo:     no de texto com indice 0 como numero filho <p>
        <i>          no de elemento com indice 1 como numero filho <p>
            itálico  no de texto como numero filho 0 de <i>
        </i>    
        e            no de texto com indice 2 como numero filho <p>
        <b>          no de elemento com indice 3 como numero filho <p>
            negrito  no de texto como numero filho 0 de <b>
        </b>
    </p>
    -->

    <script>
        /**
         * * SELECIONANDO NÓS DE ELEMENTO
         * 
         * Alternativamente, se node for um nó de elemento, então offset deve ser o número filho.
         * 
         * Isso é útil para criar intervalos que contenham nós como um todo, não parando em algum lugar dentro do texto.
         * 
         * Por exemplo, temos um fragmento de documento mais complexo:
         * 
         * Vamos fazer um intervalo para "Example: <i>italic</i>".
         * 
         * Como podemos ver, esta frase consiste em exatamente dois filhos de <p>, com índices 0 e 1:
         * 
            * O ponto inicial tem <p> como no pai e 0 como offset.
            * 
                *  Então podemos definir como range.setStart(p, 0).
            * 
            * O ponto final também tem <p> como no pai, mas 2 como offset (especifica o intervalo até, mas não incluindo offset).
            * 
                * Então podemos definir como range.setEnd(p, 2).
                * 
            *  Aqui está a demonstração. Se você executá-lo, poderá ver que o texto é selecionado:
        */

        //SELECIONANDO ELEMENTOS

        //cria um objeto range sem precisar informar argumentos, o objeto range e um par de pontos de fronteira inicio e fim do intervalo de uma seleção
        let range = new Range();

        //definindo os limites da seleção

        //especificando o inicio do intervalo de seleção por meio de range.setStart(node, offset);
        //onde node e um no de elemento e offset o numero do filho, isso e para ambos os metodos
        //a nossa seleção ira inicar no no de elemento p pai começando pelo filho de numero indexado 0, o primeiro no de texto
        range.setStart(p, 0);
        //o final do intervalo da seleção e ainda dentro do no pai de elemento p, terminando a seleção no filho de numero indexado 2 a seleção vai até ele mas não o inclui, o ultimo no de texto, mas não o incluindo
        range.setEnd(p, 2);

        // toString de um intervalo retorna seu conteúdo como texto, sem tags
        console.log(range); // Exemplo: itálico

        // aplica este intervalo para seleção de documentos (explicado mais adiante)
        document.getSelection().addRange(range);

        /**
         * * Os nós inicial e final podem ser diferentes
         * 
         * Não precisamos usar o mesmo nó em setStarte setEnd. Um intervalo pode abranger muitos nós não relacionados. É importante apenas que o fim seja após o início no documento.
         * */

    </script>
</body>
</html>