<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemplo 2</title>
</head>
<body>
    <script>

        /**
         * * EXEMPLOS DO MÉTODO JS Promise.all()
         * 
         * Vamos dar alguns exemplos para entender como o Promise.all() método funciona.
         * 
         * * 2) EXEMPLO DE PROMISES REJEITADAS
         * 
         * O Promise.all() retorna uma promessa que é rejeitada se qualquer uma das promessas de entrada for rejeitada.
        */

        //declara uma instancia de uma promise e atribui por referencia a variavel p1
        //a callback argumento passado para o construtor da promise e conhecida como executor
        const p1 = new Promise((resolve, reject) => {
            //simulando uma operação assicrona usando o setTimeout
            //espera 1 segundo de atraso para resolver a promise
            setTimeout(() => {
                console.log('The first promise has resolved');
                //usando o callbakc function resolve, para mudar o estado da promise de pendente para cumprida com valor(resolvida)
                //o valor e o 10
                resolve(10);
            }, 1 * 1000);
        });

        //declara uma instancia de uma promise e atribui por referencia a variavel p2
        //a callback argumento passado para o construtor da promise e conhecida como executor
        const p2 = new Promise((resolve, reject) => {
            //simulando uma operação assicrona usando o setTimeout
            //espera 2 segundo de atraso para rejeitar a promise
            setTimeout(() => {
                console.log('The second promise has reject');
                //usando o callbakc function reject, para mudar o estado da promise de pendente para rejeita com o motivo da rejeição
                //o argumento e o motivo da rejeição
                reject('Failed');
            }, 2 * 1000);
        });

        //declara uma instancia de uma promise e atribui por referencia a variavel p3
        //a callback argumento passado para o construtor da promise e conhecida como executor
        const p3 = new Promise((resolve, reject) => {
            //simulando uma operação assicrona usando o setTimeout
            //espera 3 segundo de atraso para resolver a promise
            setTimeout(() => {
                console.log('The first promise has resolved');
                //usando o callbakc function resolve, para mudar o estado da promise de pendente para cumprida com valor(resolvida)
                //o valor e o 10
                resolve(30);
            }, 3 * 1000);
        });

        //usando o método estatico Promise.all()
        //método retorna uma única promessa que resolve quando todas as promessas de entrada foram resolvidas. A promessa retornada resolve para uma array dos resultados das promessas de entrada
        //Se uma das promessas de entrada for rejeitada, o Promise.all() método retornará imediatamente uma promessa que rejeita com um erro da primeira promessa rejeitada:
        //o método recebe como argumento um array com as variaveis que refenciam as promises de entrada
        //o then método e usado para obter o resultado de todas as promesas que foram crumpridas, tiveram seu estado modificado de pendente para cumpridas com valor, neste caso o valor que a Promise.all método resolve e um array com os resultados das promesas de entrada resolvidas
        //a callbak argumento function anonima do then método e chamada quando o promisse.all tiver estado de  cumprido com valor(resolvido).
        //o callbak método e usado para mostrar uma promise que possui o estado de reject
        //a callbak do catch método e chamado pelo catch quando a promise possui o estado de reject com o motivo do erro
        //o primeiro then método obtem o resultado das promisses de entrada que atingiu o estado de cumprida com valor(resolvida) a callbak argumento do then mostra o resultado, das promises
        //o segundo método encadeado o cath mostra o motivo do erro pelo qual a promise de entrada teve seu estado de rejeitado com o motivo, a callbak argumento mostra o motivo do erro
        Promise.all([p1, p2, p3]).then(console.log).catch(console.log);

        /**
         * Neste exemplo, temos três promessas: a primeira é resolvida após 1 segundo, a segunda é rejeitada após 2 segundos e a terceira é resolvida após 3 segundos.
         * 
         * Como resultado, a promessa retornada é rejeitada porque a segunda promessa é rejeitada. O catch()método é executado para exibir o motivo da promessa rejeitada.
         * 
         * * RESUMO 
         * 
         * O Promise.all() método aceita uma lista de promessas e retorna uma nova promessa que resolve para uma array de resultados das promessas de entrada se todas as promessas de entrada forem resolvidas; ou rejeitar com um erro da primeira promessa rejeitada.
         * 
         * Use o Promise.all() método para agregar resultados de várias operações assíncronas.
        */
        
    </script>
</body>
</html>