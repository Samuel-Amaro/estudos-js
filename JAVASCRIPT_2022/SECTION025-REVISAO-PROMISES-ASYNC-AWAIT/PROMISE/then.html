<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>
    
    <script type="text/javascript">
        /**
         * * THEN(então)
         * 
         * O mais importante e fundamental é .then.
         * 
         A sintaxe é:
        */

        /*
        promise.then(
            function(result) {
                //manipula um resultado de sucesso
                //lidar com um resultado bem sucedido
            },
            function(error) {
                //manipula um error
                //lidar com um erro
            }
        );
        */

        /**
         * O primeiro argumento de .then é uma função que é executada quando a promessa é resolvida e recebe o resultado.
         * 
         * O segundo argumento de .then é uma função que é executada quando a promessa é rejeitada e recebe o erro.
         * 
         * Por exemplo, aqui está uma reação a uma promessa resolvida com sucesso:
        */

        //sintaxe do construtor para um objeto promisse
        //o argumento passado para o construtor promisse e uma callback chamada de executor, que e executado automaticamente, o excutor tenta executar algum trabalho
        //os argumentos do callback executor são outros callbacks chamados de resolve e reject, fornecidos pelo proprio javascript
        //se ao terminar a tentativa de realizar o trabalho o excutor pode chamar resolve(value) se o trabalho for concluido com sucesso
        //ou reject(error) se ocorreu um erro
        //o nosso codigo esta apenas dentro do executor
        //exemplop abaixo de uma promisse cumprida - promisse fulfilled
        let promise = new Promise(function(resolve, reject) {
            //executor realizando tentativa de executar trabalho
            //a função executor é executada automaticamente quando a promessa é construída
            //a function callback executor e chamada automaticamente e imediatamente por new Promisse
            // após 1 segundo sinaliza que o trabalho está concluído com o result "done"
            //apos passar 1 segundo o trabalho foi realizado e chamamos resolve("feito"), passando string "feito" como valor para sinalizar que trabalho foi bem sucedido
            //assim a promisse muda seu state propriedade para "fulfilled" e seu result propriedade para "done"
            //apos 1 segundo altera o estado da promisse para resolvido
            setTimeout(() => resolve("feito"), 1000);
        });

        //registrando uma função consumidora com metodo then, ela recebera o erro ou o resultado
        //o primeiro argumento do metodo then consumidor e uma function callback que e executada quando a promisse e resolvida e recebe o resultado
        //o segundo argumento do metodo e uma funcão que e executada quando a promisse e rejeitada e recebe o erro
        //resolve executa a primeira function no .then
        //resolve executa a primeira função em .then
        promise.then(
            result => alert(result), //mostra "done!" apos 1 segundo 
            error => alert(error) //não executa
        ); 

        /**
         * A primeira função foi executada. 
        */
    </script>

</body>
</html>